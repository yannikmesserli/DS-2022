<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <title>Coloring options for textured buildings | Sample | ArcGIS API for JavaScript 4.22</title>
    <style>
      html,
      body,
      #viewDiv {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
      }

      #colorMixMode {
        background-color: white;
        padding: 12px;
      }
    </style>

    <link rel="stylesheet" href="https://js.arcgis.com/4.22/esri/themes/light/main.css" />
    <script src="https://js.arcgis.com/4.22/"></script>

    <script>
      require([
        "esri/WebScene",
        "esri/views/SceneView",
        "esri/layers/SceneLayer",
        "esri/renderers/SimpleRenderer",
        "esri/symbols/MeshSymbol3D",
        "esri/symbols/FillSymbol3DLayer",
        "esri/symbols/PolygonSymbol3D",
        "esri/symbols/edges/SolidEdges3D",
        "esri/widgets/Fullscreen",
      ], (
        WebScene,
        SceneView,
        SceneLayer,
        SimpleRenderer,
        MeshSymbol3D,
        FillSymbol3DLayer,
        PolygonSymbol3D,
        SolidEdges3D,
        Fullscreen
      ) => {
        const doc = parent.document;
        doc.getElementById("sl-toggle-outlines").onclick = toggleOutlines;
        doc.getElementById("sl-toggle-color").onclick = toggleTexture;
        let outlines = false;
        let texture = true;

        // Load a webscene and add it to the view
        const webscene = new WebScene({
          portalItem: {
            // autocasts as new PortalItem()
            id: "03a9607d96244883af64c7f8c7e5de1b",
          },
        });

        const view = new SceneView({
          container: "viewDiv",
          map: webscene,
          camera: {
            position: {
              spatialReference: {
                latestWkid: 3857,
                wkid: 102100,
              },
              x: 2777639.282016794,
              y: 8436249.476607416,
              z: 270.45023030322045,
            },
            heading: 314.3751633889395,
            tilt: 46.58509876872484,
          },
        });

        // Create SceneLayer with textured buildings
        const layer = new SceneLayer({
          portalItem: {
            id: "fdfa7e3168e74bf5b846fc701180930b",
          },
          title: "Buildings in Helsinki",
        });

        webscene.add(layer);

        const solidEdges = new SolidEdges3D({
          color: [0, 0, 0, 0.6],
          size: 1,
        });

        function updateRenderer() {
          if (texture) {
            if (outlines) {
              layer.renderer = new SimpleRenderer({
                symbol: new MeshSymbol3D({
                  symbolLayers: [
                    new FillSymbol3DLayer({
                      edges: solidEdges,
                    }),
                  ],
                }),
              });
            } else {
              layer.renderer = null;
            }
          } else {
            layer.renderer = new SimpleRenderer({
              symbol: new MeshSymbol3D({
                symbolLayers: [
                  new FillSymbol3DLayer({
                    material: {
                      color: "#ffffff",
                      colorMixMode: "replace",
                    },
                    edges: outlines ? solidEdges : null,
                  }),
                ],
              }),
              visualVariables: [
                {
                  type: "color",
                  field: "solarAreaSuitableM2",
                  stops: [
                    {
                      value: 1,
                      color: "#FFFCD4",
                    },
                    {
                      value: 1000,
                      color: [153, 83, 41],
                    },
                  ],
                },
              ],
            });
          }
        }
        //const thematicRenderer = ;
        function toggleOutlines() {
          outlines = !outlines;
          updateRenderer();
          //layer.renderer = outlines ? outlinesRenderer : null;
        }
        function toggleTexture() {
          texture = !texture;
          console.log(outlines + " " + texture);
          updateRenderer();
          //layer.renderer = texture ? null : thematicRenderer;
        }

        const fullscreen = new Fullscreen({
          view: view,
        });
        view.ui.add(fullscreen, "bottom-left");

        view.popup = null;
      });
    </script>
  </head>

  <body>
    <div id="viewDiv"></div>
    <div id="colorMixMode" class="esri-widget">
      <input type="radio" id="original" name="mode" checked />
      <label for="original">Buildings with original texture</label> <br />
      <input type="radio" id="select" name="mode" />
      <label for="select">Show commercial buildings</label> <br />
      <input type="radio" id="emphasize" name="mode" />
      <label for="emphasize">Emphasize commercial buildings</label> <br />
      <input type="radio" id="desaturate" name="mode" />
      <label for="desaturate">Desaturate texture</label> <br />
      <input type="radio" id="replace" name="mode" />
      <label for="replace">Remove texture</label>
    </div>
  </body>
</html>
